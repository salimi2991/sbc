(function(){function b(b,c,l,n){return isNaN(b)?c:b<l?l:b>n?n:b}function Ia(b,c){for(var l={},n=1;4>n;n++){var f=b["wave"+n];if(f)for(var p in f)!isNaN(f[p])&&p in Ja&&(l[Ja[p]+n]=f[p])}if(c)for(p in Ka)p in l||(l[p]=0);return l}function ab(b,c,l,n,C){var p={},F=0,v;for(propName in c)v=mb[propName],"DOT_COLOR"!=propName&&v&&c[propName]!=b[v]&&(p[v]=c[propName],F++);F&&La.run(b,p,l,1E3*n,C);"DOT_COLOR"in c&&c.DOT_COLOR!=b.dotColor?nb.run(b,"dotColor",c.DOT_COLOR,f.lin(),1E3*n,C):F||ob.seconds(n)}function C(Z,
c){function l(a){a=m.width=$.clientWidth;var c=m.height=$.clientHeight;Ma&&(ma=c/a>Ka?a/Na:c/Oa);N&&(aa=z+w*a,ba=x+y*c)}function n(a,c,b){b=na/(oa+b);return{x:b*a,y:b*c,alpha:1>b?b*b:1,scale:b}}function $a(){var a,c,b,d,f,h,k;ca=Math.sqrt(G*G+H*H);r=G/ca||1E-4;s=-H/ca||1E-4;da=Math.sin(O+e.angle);P=Math.cos(O+e.angle);d=[[r*r+s*s*P,r*s*(1-P),s*da],[r*s*(1-P),s*s+r*r*P,-r*da],[-s*da,r*da,(r*r+s*s)*P]];k=t;var l=[],g;for(g=0;3>g;g++)for(l[g]=[],b=0;3>b;b++)l[g][b]=d[g][0]*k[0][b]+d[g][1]*k[1][b]+d[g][2]*
k[2][b];t=l;m.width=m.width;Q.fillStyle=pa;N?Q.translate(m.width/2+aa,m.height/2+ba):Q.translate(m.width/2,m.height/2);Ma&&Q.scale(ma,ma);for(l=ea;l--;)for(d=4*l/ea*ia-bb,g=k=Math.round(ea*(2+qa*Math.cos(.5*d+.5*Math.PI))/ra);g--;)a=g/k*2*ia-ia,f=(sa+e.amp1*Math.sin(e.freq1*d+e.pha1))*(1-ja+ja*Math.sin(.5*d)),c=ta+e.amp2*Math.sin(e.freq2*a+e.pha2)+e.amp3*Math.sin(e.freq3*d+e.pha3),b=(f+c*Math.cos(a))*Math.cos(d),f=(f+c*Math.cos(a))*Math.sin(d),h=c*Math.sin(a)+ua*Math.sin(.5*d+Math.PI/2),a=t[0][0]*
b+t[0][1]*f+t[0][2]*h,c=t[1][0]*b+t[1][1]*f+t[1][2]*h,b=t[2][0]*b+t[2][1]*f+t[2][2]*h,b=n(a,c,b),f=va*b.scale,Q.globalAlpha=b.alpha,0<f&&Q.fillRect(b.x,b.y,f,f)}function p(a){var b=m.getBoundingClientRect();return{x:a.clientX-b.left-aa,y:a.clientY-b.top-ba}}function F(a){wa=(new Date).getTime();wa-Pa>1E3/cb&&(q=p(a),R=q.x-xa,S=q.y-ya,T=Math.sqrt(R*R+S*S),ka=Math.sqrt((q.x-m.width/2)*(q.x-m.width/2)+(q.y-m.height/2)*(q.y-m.height/2)),T&&ka<U&&(za=ka<D?1:(U-ka)/(U-D),Math.abs(Math.acos((R*Qa+S*Ra)/
(Sa*T)))>Math.PI/2&&(I*=-1,O=I*fa),Math.min(T,Ta)*J*za>Math.abs(e.angle)&&(Ua.stop(),e.angle=I*Math.min(T,Ta)*J*za,H=I*R,G=I*S,Ua=La.run(e,{angle:0},f.powOut(3),Aa,A)),Qa=R,Ra=S,Sa=T),xa=q.x,ya=q.y,Pa=wa)}function v(a){document.removeEventListener("mousemove",v);q=p(a);xa=q.x;ya=q.y;document.addEventListener("mousemove",F)}var Ba=document.getElementById(Z);if(Ba){C.instances[Z]&&C.instances[Z].destroy();C.instances[Z]=this;c||(c={});var d=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,cb=30,
Ta=100,ia=Math.PI,bb=ia/2,Ma=c.AUTO_SCALE,Na=b(c.VIEWPORT_WIDTH,800,100,d),Oa=b(c.VIEWPORT_HEIGHT,800,100,d),ea=Math.round(b(c.DETALIZATION,180,1,d)),sa=b(c.TUBE_SIZE,220,1,d),ga=b(c.TUBE_DISTANCE,1E3,0,d),fa=b(c.ROTATION_SPEED,5,0,d)/1E3,E=b(c.PERSPECTIVE_DISTORTION,1,.001,d),z=b(c.OFFSET_X,0,g,d),x=b(c.OFFSET_Y,0,g,d),w=b(c.PERCENTAGE_OFFSET_X,0,g,d)/100,y=b(c.PERCENTAGE_OFFSET_Y,0,g,d)/100,ta=b(c.TUBE_WIDTH,50,g,d),ra=b(c.MESH_RATIO,14,.5,d),qa=b(c.MESH_DISTRIBUTION,0,-2,2),ja=b(c.TUBE_TORSION,
.3,g,d),ua=b(c.TUBE_STRETCH,200,g,d),Va=c.USE_MAIN_MORPHING,db="MAIN_MORPHING_AUTOPLAY"in c?c.MAIN_MORPHING_AUTOPLAY:!0,Wa=b(c.MAIN_MORPHING_DURATION,2,0,d),eb=b(c.MAIN_MORPHING_DELAY,1,0,d),V=c.MAIN_MORPHING_TRANSITION_TYPE||"cubic",W=c.MAIN_MORPHING_STAGES||[],va=b(c.DOT_SIZE,2,0,d),pa=c.DOT_COLOR||"black",D=b(c.MOUSE_DISTANCE_MIN,20,0,d),U=b(c.MOUSE_DISTANCE_MAX,D+400,D+.001,d),J=b(c.MOUSE_SENSITIVITY,1,0,d)/1E3,Aa=1E3*b(c.INERTIAL_TIME,2,0,d),fb=c.SURFACE_INITIAL_DISTORTION||{wave1:{amplitude:0,
frequency:0,phase:0},wave2:{amplitude:0,frequency:0,phase:0},wave3:{amplitude:0,frequency:0,phase:0}},la=c.USE_SURFACE_MORPHING,Ca=c.USE_SURFACE_MOTION,Xa=c.USE_SURFACE_SWING,gb="SURFACE_MORPHING_AUTOPLAY"in c?c.SURFACE_MORPHING_AUTOPLAY:!0,Ya=b(c.SURFACE_MORPHING_DURATION,2,0,d),hb=b(c.SURFACE_MORPHING_DELAY,1,0,d),X=c.SURFACE_MORPHING_TRANSITION_TYPE||"cubic",u=c.SURFACE_MORPHING_STAGES||[];if(Ca&&la&&u.length)for(var B=1;4>B;B++)if(c["WAVE_"+B+"_MOTION_SPEED"])for(var h=u.length;h--;){var ha=u[h]["wave"+
B];ha&&"phase"in ha&&delete ha.phase}if(Xa)for(B=1;4>B;B++){var Y=c["WAVE_"+B+"_SWING_SETTINGS"];if(Y){for(var K in Y){var k=Y[K];if(k){if(la)for(h=u.length;h--;)(ha=u[h]["wave"+B])&&K in ha&&delete ha[K];"type"in k&&(k.wave=("function"===typeof k.type?k.type:pb[k.type])||Da.sin,delete k.type);"amplitude"in k&&isNaN(k.amplitude)&&delete k.amplitude;"frequency"in k&&isNaN(k.frequency)&&delete k.frequency;"phase"in k&&isNaN(k.phase)&&delete k.phase}}Y.phase&&Ca&&(c["WAVE_"+B+"_MOTION_SPEED"]=0)}}var Ea=
c.WAVE_1_MOTION_SPEED,Fa=c.WAVE_2_MOTION_SPEED,Ga=c.WAVE_3_MOTION_SPEED,oa=ga/E,na=1E3/E,$=function(){var a=document.createElement("div");ib.set(a,{position:"relative",width:"100%",height:"100%",top:0,left:0,margin:0,userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none",KhtmlUserSelect:"none",userDrag:"none",WebkitUserDrag:"none",overflow:"hidden",cursor:"default"});a.setAttribute("unselectable","on");Ba.appendChild(a);return a}(),m=function(){var a=document.createElement("canvas");
ib.set(a,{position:"absolute",width:"100%",height:"100%",top:0,left:0,margin:0});$.appendChild(a);return a}(),Q=m.getContext("2d"),A=new qb,e=function(){var a={set:function(a){for(var b in a)this[b]=a[b]},angle:0},b=Ia(fb,!0),c;for(c in b)a[c]=b[c];return a}(),H=5,G=5,I=1,O=fa,Ua={stop:function(){}},da=Math.sin(O),P=Math.cos(O),ca=Math.sqrt(G*G+H*H),r=G/ca,s=-H/ca,t=[[1,0,0],[0,1,0],[0,0,1]],ka,za,q,Qa=0,Ra=0,Sa=0,R,S,T,xa,ya,wa,Pa=(new Date).getTime(),ma,aa=0,ba=0,N=z||x||w||y,Ka=Oa/Na;this.resize=
function(){l()};this.destroy=function(){C.instances[Z]=null;A.removeAllListeners();L&&L.clear();M&&M.clear();window.removeEventListener("resize",l);document.removeEventListener("mousemove",v);document.removeEventListener("mousemove",F);$.removeChild(m);Ba.removeChild($);Ba=Z=c=d=g=cb=Ta=ia=bb=ea=sa=fa=E=ta=ra=qa=ja=ua=Ma=Na=Oa=va=pa=D=U=J=Aa=fb=Va=la=Ca=Xa=db=Wa=eb=V=W=gb=Ya=hb=X=u=Ea=Fa=Ga=ga=oa=na=z=x=w=y=$=m=Q=A=e=H=G=I=O=Ua=da=P=ca=r=s=t=ka=za=q=Qa=Ra=Sa=R=S=T=xa=ya=wa=Pa=L=M=ma=l=n=$a=p=F=v=
N=aa=ba=null;for(K in this)delete this[K];this.resize=this.destroy=this.mainMorphTo=this.surfaceMorphTo=function(){}};this.mainMorphTo=function(a){if(Va&&W.length){var b;a&&"object"===typeof a?b=a:!isNaN(a)&&0<=a&&a<W.length&&!(a-Math.floor(a))&&(b=W[a]);b&&ab(this,b,"function"===typeof V?V:Ha[V],Wa,A)}};this.surfaceMorphTo=function(a){if(la&&u.length){var b;a&&"object"===typeof a?b=a:!isNaN(a)&&0<=a&&a<u.length&&!(a-Math.floor(a))&&(b=u[a]);b&&La.run(e,Ia(b),"function"===typeof X?X:Ha[X],1E3*Ya,
A)}};Object.defineProperties(this,{detalization:{get:function(){return ea},set:function(a){ea=Math.round(b(a,60,1,d))},configurable:!0},tubeSize:{get:function(){return sa},set:function(a){sa=b(a,220,1,d)},configurable:!0},tubeDistance:{get:function(){return ga},set:function(a){ga=b(a,1E3,0,d);oa=ga/E;na=1E3/E},configurable:!0},rotationSpeed:{get:function(){return 1E3*fa},set:function(a){fa=b(a,5,0,d)/1E3;O=I*fa},configurable:!0},tubeWidth:{get:function(){return ta},set:function(a){ta=b(a,50,g,d)},
configurable:!0},tubeTorsion:{get:function(){return ja},set:function(a){ja=b(a,.3,g,d)},configurable:!0},tubeStretch:{get:function(){return ua},set:function(a){ua=b(a,200,g,d)},configurable:!0},perspectiveDistortion:{get:function(){return E},set:function(a){E=b(a,1,.001,d);oa=ga/E;na=1E3/E},configurable:!0},offsetX:{get:function(){return z},set:function(a){N=(z=b(a,0,g,d))||x||w||y;aa=z+w*m.width},configurable:!0},offsetY:{get:function(){return x},set:function(a){x=b(a,0,g,d);N=z||x||w||y;ba=x+y*
m.height},configurable:!0},percentageOffsetX:{get:function(){return 100*w},set:function(a){w=b(a,0,g,d)/100;N=z||x||w||y;aa=z+w*m.width},configurable:!0},percentageOffsetY:{get:function(){return 100*y},set:function(a){y=b(a,0,g,d)/100;N=z||x||w||y;ba=x+y*m.height},configurable:!0},dotSize:{get:function(){return va},set:function(a){va=b(a,2,0,d)},configurable:!0},dotColor:{get:function(){return pa},set:function(a){pa=a||"black"},configurable:!0},meshDistribution:{get:function(){return qa},set:function(a){qa=
b(a,.3,-2,2)},configurable:!0},meshRatio:{get:function(){return ra},set:function(a){ra=b(a,4,.5,d)},configurable:!0},mouseDistanceMin:{get:function(){return D},set:function(a){D=b(a,20,0,U-1E-4)},configurable:!0},mouseDistanceMax:{get:function(){return U},set:function(a){U=b(a,D+400,D+.001,d)},configurable:!0},mouseSensitivity:{get:function(){return J},set:function(a){var c=J;(J=b(a,1,0,d)/1E3)&&!c?document.addEventListener("mousemove",v):c&&!J&&(document.removeEventListener("mousemove",v),document.removeEventListener("mousemove",
F))},configurable:!0},inertialTime:{get:function(){return Aa},set:function(a){Aa=1E3*b(a,2,0,d)},configurable:!0},wave1Amplitude:{get:function(){return e.amp1},set:function(a){e.amp1=a},configurable:!0},wave2Amplitude:{get:function(){return e.amp2},set:function(a){e.amp2=a},configurable:!0},wave3Amplitude:{get:function(){return e.amp3},set:function(a){e.amp3=a},configurable:!0},wave1Frequency:{get:function(){return e.freq1},set:function(a){e.freq1=a},configurable:!0},wave2Frequency:{get:function(){return e.freq2},
set:function(a){e.freq2=a},configurable:!0},wave3Frequency:{get:function(){return e.freq3},set:function(a){e.freq3=a},configurable:!0},wave1Phase:{get:function(){return e.pha1},set:function(a){e.pha1=a},configurable:!0},wave2Phase:{get:function(){return e.pha2},set:function(a){e.pha2=a},configurable:!0},wave3Phase:{get:function(){return e.pha3},set:function(a){e.pha3=a},configurable:!0}});window.addEventListener("resize",l);l();if(Va&&db&&W.length){var M=new jb;M.delay=eb;for(var h=0,Za=W.length;h<
Za;h++)M.addTask(ab,this,W[h],"function"===typeof V?V:Ha[V],Wa,A);M.addQueue(M);M.run()}if(la&&gb&&u.length){var L=new jb;L.delay=hb;h=0;for(Za=u.length;h<Za;h++)L.addTween(e,Ia(u[h]),"function"===typeof X?X:Ha[X],Ya,A);L.addQueue(L);L.run()}if(Ca){var kb=function(){var a={},b=0;Ea&&!isNaN(Ea)&&(a.pha1=Ea,b++);Fa&&!isNaN(Fa)&&(a.pha2=Fa,b++);Ga&&!isNaN(Ga)&&(a.pha3=Ga,b++);return b?new rb(e,a,A):0}();kb&&kb.play()}if(Xa)for(h=1;4>h;h++)if(Y=c["WAVE_"+h+"_SWING_SETTINGS"])for(K in Y){var lb=Ja[K];
lb&&(new sb(e,lb+h,Y[K],A)).play()}A.addListener($a);J&&document.addEventListener("mousemove",v)}else alert("TubeAnimation ERROR: There is no element with the specified id")}var qb=jsband.Metronome,f=jsband.Ease,La=jsband.Tween,ob=jsband.Pause,nb=jsband.ColorTween,ib=jsband.CssProp,jb=jsband.Queue,sb=jsband.Swing,Da=jsband.Wave,rb=jsband.Motion,Ha={linear:f.lin(),quad:f.pow(2),cubic:f.pow(3),quart:f.pow(4),quint:f.pow(5),circ:f.circ(),sine:f.sin(),expo:f.exp(),elastic:f.osc2Out(),bounce:f.bncOut(),
back:f.backOut()},pb={sine:Da.sin,linear:Da.triangle,pulse:Da.pulse},Ka={amp1:1,freq1:1,pha1:1,amp2:1,freq2:1,pha2:1,amp3:1,freq3:1,pha3:1},Ja={amplitude:"amp",frequency:"freq",phase:"pha"},mb={TUBE_SIZE:"tubeSize",TUBE_DISTANCE:"tubeDistance",DETALIZATION:"detalization",PERSPECTIVE_DISTORTION:"perspectiveDistortion",TUBE_WIDTH:"tubeWidth",TUBE_TORSION:"tubeTorsion",TUBE_STRETCH:"tubeStretch",ROTATION_SPEED:"rotationSpeed",DOT_SIZE:"dotSize",DOT_COLOR:"dotColor",MESH_DISTRIBUTION:"meshDistribution",
MESH_RATIO:"meshRatio"};C.instances={};window.TubeAnimation=C})();
